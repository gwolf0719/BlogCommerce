# BlogCommerce 完整端到端測試計劃

## 測試目標
測試 BlogCommerce 平台的完整用戶流程，包括：
- 用戶註冊和登入
- 商品瀏覽和購物車操作
- 優惠券功能
- 結帳和付款流程
- 後台管理功能

## 測試環境
- **前端**: Vue.js + Ant Design Vue
- **後端**: FastAPI + SQLAlchemy + PostgreSQL
- **測試工具**: Playwright + Vitest
- **測試瀏覽器**: Chrome, Firefox, Safari

## 測試流程設計

### 1. 用戶註冊流程測試
#### 1.1 正常註冊流程
- **測試步驟**：
  1. 訪問註冊頁面 `/register`
  2. 填寫有效的用戶資料
  3. 點擊註冊按鈕
  4. 驗證註冊成功訊息
  5. 檢查自動登入狀態
  6. 驗證用戶資料存儲

- **驗證點**：
  - 註冊表單驗證正確
  - 密碼加密存儲
  - 用戶狀態正確（is_active=True）
  - 自動登入成功

#### 1.2 註冊錯誤處理
- **測試場景**：
  - 用戶名已存在
  - 電子郵件已存在
  - 密碼不符合要求
  - 必填欄位為空
  - 電子郵件格式不正確

### 2. 用戶登入流程測試
#### 2.1 正常登入流程
- **測試步驟**：
  1. 訪問登入頁面 `/login`
  2. 輸入正確的用戶名和密碼
  3. 點擊登入按鈕
  4. 驗證登入成功
  5. 檢查 token 存儲
  6. 驗證用戶狀態更新

#### 2.2 登入重定向測試
- **測試場景**：
  - 未登入用戶訪問結帳頁面
  - 登入後自動重定向到結帳頁面
  - 從購物車點擊結帳的重定向流程

#### 2.3 登入錯誤處理
- **測試場景**：
  - 用戶名不存在
  - 密碼錯誤
  - 帳戶被停用
  - 空白輸入

### 3. 商品瀏覽和購物車測試
#### 3.1 商品瀏覽
- **測試步驟**：
  1. 訪問商品列表頁面 `/products`
  2. 點擊商品進入詳情頁面
  3. 查看商品詳細資訊
  4. 驗證商品價格、庫存等資訊

#### 3.2 購物車操作
- **測試步驟**：
  1. 在商品詳情頁面添加商品到購物車
  2. 驗證購物車計數更新
  3. 訪問購物車頁面 `/cart`
  4. 修改商品數量
  5. 移除商品
  6. 清空購物車

#### 3.3 購物車邊界測試
- **測試場景**：
  - 添加超過庫存的數量
  - 添加已下架的商品
  - 購物車為空時的操作
  - 庫存不足時的提示

### 4. 優惠券功能測試
#### 4.1 優惠券創建（後台）
- **測試步驟**：
  1. 管理員登入後台
  2. 進入優惠券管理頁面
  3. 創建不同類型的優惠券：
     - 商品折扣券
     - 整筆折扣券
     - 免運費券
  4. 設置優惠券條件和有效期
  5. 驗證優惠券創建成功

#### 4.2 優惠券分發（後台）
- **測試步驟**：
  1. 選擇已創建的優惠券
  2. 進行批次分發
  3. 指定分發對象（全部用戶/特定用戶）
  4. 驗證分發記錄

#### 4.3 優惠券使用（前台）
- **測試步驟**：
  1. 用戶登入後進入結帳頁面
  2. 輸入有效的優惠碼
  3. 點擊套用按鈕
  4. 驗證優惠金額計算
  5. 完成訂單並使用優惠券

#### 4.4 優惠券驗證測試
- **測試場景**：
  - 有效優惠碼的套用
  - 無效優惠碼的處理
  - 已過期優惠碼
  - 已使用優惠碼
  - 未達到使用條件的優惠碼
  - 優惠碼重複使用

### 5. 結帳和付款流程測試
#### 5.1 結帳前檢查
- **測試步驟**：
  1. 未登入用戶點擊結帳按鈕
  2. 驗證登入提示
  3. 登入後自動重定向到結帳頁面
  4. 購物車為空時的處理

#### 5.2 結帳資料填寫
- **測試步驟**：
  1. 填寫收件人資訊
  2. 填寫聯絡方式
  3. 填寫收件地址
  4. 選擇付款方式
  5. 驗證表單驗證邏輯

#### 5.3 優惠碼在結帳中的使用
- **測試步驟**：
  1. 在結帳頁面輸入優惠碼
  2. 驗證優惠碼
  3. 查看折扣金額
  4. 確認最終金額計算
  5. 移除優惠碼功能

#### 5.4 付款流程
- **測試場景**：
  - 銀行轉帳付款
  - Line Pay 付款（如果啟用）
  - 綠界金流付款（如果啟用）
  - 付款失敗處理

### 6. 訂單管理測試
#### 6.1 訂單創建
- **測試步驟**：
  1. 完成結帳流程
  2. 驗證訂單創建成功
  3. 檢查訂單狀態
  4. 驗證庫存扣減
  5. 驗證優惠券使用記錄

#### 6.2 訂單查詢（前台）
- **測試步驟**：
  1. 用戶登入後查看訂單列表
  2. 點擊訂單查看詳情
  3. 驗證訂單資訊完整性

#### 6.3 訂單管理（後台）
- **測試步驟**：
  1. 管理員登入後台
  2. 查看訂單列表
  3. 更新訂單狀態
  4. 查看訂單詳情
  5. 處理退款申請

### 7. 後台管理功能測試
#### 7.1 管理員權限測試
- **測試場景**：
  - 一般用戶無法訪問後台
  - 管理員可以訪問所有功能
  - 權限驗證正確

#### 7.2 商品管理
- **測試步驟**：
  1. 創建新商品
  2. 編輯商品資訊
  3. 上傳商品圖片
  4. 設置商品狀態
  5. 刪除商品

#### 7.3 用戶管理
- **測試步驟**：
  1. 查看用戶列表
  2. 編輯用戶資訊
  3. 停用/啟用用戶
  4. 查看用戶訂單記錄

#### 7.4 優惠券管理
- **測試步驟**：
  1. 創建優惠券
  2. 編輯優惠券
  3. 分發優惠券
  4. 查看使用統計
  5. 停用優惠券

### 8. 系統整合測試
#### 8.1 併發測試
- **測試場景**：
  - 多用戶同時購買同一商品
  - 庫存不足時的處理
  - 優惠券同時使用的限制

#### 8.2 資料一致性測試
- **測試場景**：
  - 訂單和庫存的一致性
  - 優惠券使用記錄的準確性
  - 購物車和訂單的同步

#### 8.3 效能測試
- **測試場景**：
  - 大量商品載入
  - 複雜查詢效能
  - 高併發下的響應時間

### 9. 錯誤處理和邊界測試
#### 9.1 網路錯誤
- **測試場景**：
  - 網路中斷時的處理
  - API 請求失敗的重試機制
  - 使用者友好的錯誤訊息

#### 9.2 資料驗證
- **測試場景**：
  - 前端驗證繞過
  - 後端驗證完整性
  - SQL 注入防護

#### 9.3 邊界條件
- **測試場景**：
  - 超大數量的商品
  - 極長的文字輸入
  - 特殊字符處理

## 測試執行策略

### 自動化測試
1. **單元測試**: 覆蓋核心業務邏輯
2. **整合測試**: 測試 API 端點
3. **端到端測試**: 完整用戶流程

### 手動測試
1. **用戶體驗測試**: 界面友好性
2. **跨瀏覽器測試**: 兼容性驗證
3. **行動裝置測試**: 響應式設計

### 測試資料管理
1. **測試資料隔離**: 每個測試使用獨立資料
2. **資料清理**: 測試後清理測試資料
3. **資料備份**: 重要測試資料的備份

## 測試報告要求

### 測試結果記錄
- 測試案例執行狀態
- 發現的問題和錯誤
- 效能指標記錄
- 截圖和錯誤日誌

### 問題追蹤
- 問題嚴重程度分類
- 問題修復狀態追蹤
- 回歸測試結果

### 測試總結
- 測試覆蓋率
- 功能完整性評估
- 系統穩定性評估
- 改進建議

## 測試時程安排

### 階段一：基礎功能測試（2天）
- 用戶註冊和登入
- 商品瀏覽和購物車
- 基本訂單流程

### 階段二：優惠券功能測試（2天）
- 優惠券創建和分發
- 優惠券使用流程
- 優惠券驗證邏輯

### 階段三：整合測試（2天）
- 端到端流程測試
- 後台管理功能
- 系統整合驗證

### 階段四：效能和安全測試（1天）
- 負載測試
- 安全漏洞檢測
- 效能優化驗證

## 測試成功標準

### 功能完整性
- 所有核心功能正常運行
- 用戶流程順暢無阻
- 錯誤處理機制完善

### 系統穩定性
- 無嚴重 bug 和崩潰
- 高併發下穩定運行
- 資料一致性保證

### 用戶體驗
- 界面友好易用
- 響應時間合理
- 錯誤訊息清晰

## 風險評估

### 高風險項目
- 付款流程安全性
- 庫存管理準確性
- 優惠券濫用防護

### 中風險項目
- 系統效能表現
- 跨瀏覽器兼容性
- 資料備份恢復

### 低風險項目
- 界面美觀度
- 非核心功能
- 文檔完整性

## 測試工具和環境

### 測試工具
- **Playwright**: 端到端測試
- **Vitest**: 單元測試
- **Postman**: API 測試
- **Jest**: JavaScript 測試

### 測試環境
- **開發環境**: 本地測試
- **測試環境**: 獨立測試伺服器
- **生產環境**: 生產前驗證

### 測試資料
- **測試用戶**: 不同角色用戶
- **測試商品**: 各種類型商品
- **測試優惠券**: 各種類型優惠券 