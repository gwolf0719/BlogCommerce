# 管理後台資料夾遷移測試計畫

## 測試日期: 2025-01-07

## 測試目標
1. 將後台未編譯原始碼從 `frontend` 資料夾移到 `admin-src` 資料夾
2. 確保封裝後放到 `admin` 資料夾，修訂相關部署腳本
3. 驗證後台設定功能與前台的對應關係
4. 確認後台編輯內容預設載入原先的資料

## 測試項目

### 1. 資料夾遷移測試
- **測試內容**: 將 `frontend` 資料夾重新命名為 `admin-src`
- **執行步驟**: `mv frontend admin-src`
- **測試結果**: ✅ 成功
- **備註**: 資料夾成功遷移，無丟失檔案

### 2. 建置配置更新測試
- **測試內容**: 修改 `admin-src/vite.config.js` 中的 `outDir` 設定
- **修改項目**: `outDir: '../app/static'` → `outDir: '../admin'`
- **測試結果**: ✅ 成功
- **備註**: 建置輸出目錄更新完成

### 3. 部署腳本更新測試
#### 3.1 start.sh 腳本更新
- **修改項目**: 
  - `build_frontend()` 函數中的 `cd frontend` → `cd admin-src`
  - `start_dev_frontend()` 函數中的 `cd frontend` → `cd admin-src`
- **測試結果**: ✅ 成功

#### 3.2 start_server.sh 腳本更新
- **修改項目**: `cd frontend` → `cd admin-src`
- **測試結果**: ✅ 成功

#### 3.3 install.sh 腳本更新
- **修改項目**: 
  - 檢查資料夾存在: `frontend` → `admin-src`
  - 進入資料夾: `cd frontend` → `cd admin-src`
  - 說明文字: `cd frontend` → `cd admin-src`
- **測試結果**: ✅ 成功

#### 3.4 .gitignore 更新
- **修改項目**: 
  - `frontend/node_modules/` → `admin-src/node_modules/`
  - `frontend/dist/` → `admin-src/dist/`
  - 其他相關路徑
- **測試結果**: ✅ 成功

### 4. 後端路由更新測試
- **測試內容**: 修改 `app/main.py` 中的 Admin SPA 路徑設定
- **修改項目**: `admin_spa_path = Path("app/static")` → `admin_spa_path = Path("admin")`
- **測試結果**: ✅ 成功
- **備註**: 後台頁面可正常訪問

### 5. 服務啟動測試
- **測試內容**: 使用更新後的腳本啟動服務
- **執行命令**: `./start.sh prod 8002`
- **測試結果**: ✅ 成功
- **驗證項目**:
  - 後台建置正常: ✅
  - 服務啟動成功: ✅
  - 後台頁面可訪問: ✅ (http://localhost:8002/admin)

### 6. 後台與前台設定對應測試
#### 6.1 前台模板使用設定
- **測試內容**: 檢查前台模板是否正確使用後台設定
- **檢查項目**:
  - `settings.site_name` 在多個模板中使用: ✅
  - `settings.site_description` 在頁面描述中使用: ✅
  - `settings.blog_enabled` 控制部落格功能顯示: ✅
  - `settings.shop_enabled` 控制商店功能顯示: ✅
  - 功能開關在導航中正確顯示/隱藏: ✅
- **測試結果**: ✅ 成功
- **備註**: 前台完全依賴後台設定進行功能控制

#### 6.2 設定 API 端點測試
- **測試內容**: 檢查後端設定 API 是否完整
- **API 端點**:
  - `/api/admin/settings` (GET/PUT): ✅ 存在
  - `/api/settings/public`: ✅ 存在
  - `/api/settings/payment/settings`: ✅ 存在
- **測試結果**: ✅ 成功
- **備註**: 後端設定 API 功能完整

### 7. 後台編輯表單預載測試
#### 7.1 基本設定載入測試
- **測試內容**: 驗證後台設定頁面是否載入原有資料
- **測試頁面**: http://localhost:8002/admin/settings
- **檢查項目**:
  - 網站名稱: "BlogCommerce22" ✅ (顯示已修改的值)
  - 網站標語: "部落格與電商整合平台" ✅
  - 網站描述: "一個結合部落格與電商功能的現代化平台" ✅
  - 網站網址: "http://localhost:8000" ✅
  - 時區: "Asia/Taipei" ✅
  - 語言: "繁體中文" ✅
- **測試結果**: ✅ 成功

#### 7.2 功能開關載入測試
- **測試內容**: 驗證功能開關分頁是否載入原有狀態
- **檢查項目**:
  - 部落格功能: 開啟 ✅
  - 商店功能: 開啟 ✅
  - 會員註冊: 開啟 ✅
  - 評論功能: 開啟 ✅
  - 搜尋功能: 開啟 ✅
  - 數據分析: 開啟 ✅
  - 電子報: 關閉 ✅
  - 維護模式: 關閉 ✅
- **測試結果**: ✅ 成功

#### 7.3 設定載入邏輯測試
- **測試內容**: 檢查前端載入設定的邏輯
- **實現方式**: 
  - `loadSettings()` 方法在頁面載入時執行
  - 從 `/api/admin/settings` 獲取設定數據
  - 將數據映射到表單欄位
  - 提供預設值處理機制
- **測試結果**: ✅ 成功
- **備註**: 每個欄位都正確載入並顯示原有數據

## 總結

### 完成項目
1. ✅ 成功將後台原始碼從 `frontend` 移動到 `admin-src`
2. ✅ 更新建置配置，輸出到 `admin` 資料夾
3. ✅ 修改所有相關部署腳本和配置文件
4. ✅ 驗證後台與前台設定對應關係完整
5. ✅ 確認後台編輯表單正確預載原有資料

### 測試通過率
- 資料夾遷移: 100%
- 腳本更新: 100%
- 服務運行: 100%
- 設定對應: 100%
- 表單預載: 100%
- **整體通過率: 100%**

### 注意事項
1. 所有相關文檔和說明文件需要同步更新資料夾名稱
2. 開發團隊需要知悉新的資料夾結構
3. CI/CD 流程如有相關設定也需要同步更新

### 建議
1. 建議在正式環境部署前再次執行完整測試
2. 建議更新專案文檔以反映新的資料夾結構
3. 建議通知所有開發人員關於資料夾結構的變更 