{% extends "base.html" %}

{% block title %}{{ settings.site_name }} - {{ settings.site_description }}{% endblock %}

{% block meta %}
<meta property="og:title" content="{{ settings.site_name }}">
<meta property="og:description" content="{{ settings.site_description }}">
<meta property="og:type" content="website">
{% endblock %}

{% block content %}
<div x-data="homeApp()" x-init="loadContent()">
    <!-- Hero Section -->
    <section class="relative bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 overflow-hidden">
        <!-- èƒŒæ™¯è£é£¾ -->
        <div class="absolute inset-0">
            <div class="absolute top-0 -left-4 w-72 h-72 bg-primary-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
            <div class="absolute top-0 -right-4 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
            <div class="absolute -bottom-8 left-20 w-72 h-72 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
        </div>
        
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 lg:py-24">
            <div class="text-center">
                <!-- ä¸»æ¨™é¡Œ -->
                <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6">
                    <span class="block">æ­¡è¿ä¾†åˆ°</span>
                    <span class="block bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent">
                        {{ settings.site_name }}
                    </span>
                </h1>
                
                <!-- æè¿°æ–‡å­— -->
                <p class="text-xl sm:text-2xl text-primary-100 mb-10 max-w-3xl mx-auto leading-relaxed">
                    {{ settings.site_description }}
                </p>
                
                <!-- è¡Œå‹•æŒ‰éˆ• -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="/products" class="inline-flex items-center justify-center px-8 py-4 bg-white text-primary-700 rounded-2xl font-semibold hover:bg-gray-50 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9a2 2 0 012-2z"></path>
                        </svg>
                        æ¢ç´¢å•†å“
                    </a>
                    <a href="/blog" class="inline-flex items-center justify-center px-8 py-4 bg-transparent text-white border-2 border-white rounded-2xl font-semibold hover:bg-white hover:text-primary-700 transition-all duration-300 transform hover:scale-105">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                        </svg>
                        é–±è®€éƒ¨è½æ ¼
                    </a>
                </div>
            </div>
        </div>
        
        <!-- å‘ä¸‹ç®­é ­ -->
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 lg:py-24 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4">ç‚ºä»€éº¼é¸æ“‡æˆ‘å€‘ï¼Ÿ</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">æˆ‘å€‘è‡´åŠ›æ–¼æä¾›æœ€å„ªè³ªçš„ç”¢å“èˆ‡æœå‹™é«”é©—</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- ç‰¹è‰² 1 -->
                <div class="bg-gradient-to-br from-primary-50 to-primary-100 rounded-3xl p-8 text-center group hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                    <div class="w-16 h-16 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">å¿«é€Ÿé…é€</h3>
                    <p class="text-gray-600 leading-relaxed">24å°æ™‚å…§å¿«é€Ÿå‡ºè²¨ï¼Œè®“æ‚¨æœ€å¿«æ™‚é–“æ”¶åˆ°å¿ƒæ„›çš„å•†å“</p>
                </div>
                
                <!-- ç‰¹è‰² 2 -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-3xl p-8 text-center group hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                    <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">å“è³ªä¿è­‰</h3>
                    <p class="text-gray-600 leading-relaxed">åš´æ ¼çš„å“è³ªæ§ç®¡ï¼Œç¢ºä¿æ¯å€‹å•†å“éƒ½ç¬¦åˆæœ€é«˜æ¨™æº–</p>
                </div>
                
                <!-- ç‰¹è‰² 3 -->
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-3xl p-8 text-center group hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                    <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">å°ˆæ¥­æœå‹™</h3>
                    <p class="text-gray-600 leading-relaxed">å°ˆæ¥­å®¢æœåœ˜éšŠï¼Œæä¾›å³æ™‚ä¸”è²¼å¿ƒçš„è³¼ç‰©è«®è©¢æœå‹™</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="py-16 lg:py-24 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4">ç²¾é¸å•†å“</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto mb-8">ç™¼ç¾æˆ‘å€‘ç²¾å¿ƒæŒ‘é¸çš„ç†±é–€å•†å“</p>
                <div class="w-24 h-1 bg-gradient-to-r from-primary-500 to-primary-600 mx-auto rounded-full"></div>
            </div>
            
            <!-- Loading State -->
            <div x-show="productsLoading" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <template x-for="i in 4">
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-pulse">
                        <div class="aspect-square bg-gray-200"></div>
                        <div class="p-6">
                            <div class="h-4 bg-gray-200 rounded mb-2"></div>
                            <div class="h-4 bg-gray-200 rounded w-2/3 mb-4"></div>
                            <div class="h-6 bg-gray-200 rounded w-1/2"></div>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- Products Grid -->
            <div x-show="!productsLoading" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <template x-for="product in featuredProducts" :key="product.id">
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 group overflow-hidden flex flex-col h-full">
                        <!-- å•†å“åœ–ç‰‡ -->
                        <div class="aspect-square overflow-hidden bg-gray-100 relative">
                            <img :src="product.featured_image || '/static/images/default-product.jpg'" 
                                 :alt="product.name"
                                 class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                            
                            <!-- æŠ˜æ‰£æ¨™ç±¤ -->
                            <div x-show="product.sale_price && product.sale_price < product.price" 
                                 class="absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium">
                                æŠ˜æ‰£
                            </div>
                            
                            <!-- å¿«é€ŸåŠ å…¥è³¼ç‰©è»Š -->
                            <button @click="addToCart(product.id, 1)" 
                                    class="absolute bottom-4 right-4 w-12 h-12 bg-primary-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-primary-700 transform hover:scale-110">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 9M7 13h10"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- å•†å“è³‡è¨Š -->
                        <div class="p-6 flex flex-col flex-grow">
                            <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2 group-hover:text-primary-600 transition-colors duration-200 h-12 flex items-center" x-text="product.name"></h3>
                            <p class="text-gray-600 text-sm mb-4 line-clamp-3 flex-grow h-16 overflow-hidden" x-text="product.short_description"></p>
                            
                            <!-- åƒ¹æ ¼ -->
                            <div class="flex items-center space-x-2 mb-4">
                                <span x-show="product.sale_price && product.sale_price < product.price" 
                                      class="text-xl font-bold text-red-600" 
                                      x-text="'NT$ ' + product.sale_price.toLocaleString()"></span>
                                <span :class="product.sale_price && product.sale_price < product.price ? 'text-sm text-gray-500 line-through' : 'text-xl font-bold text-gray-900'" 
                                      x-text="'NT$ ' + product.price.toLocaleString()"></span>
                            </div>
                            
                            <!-- æŸ¥çœ‹è©³æƒ…æŒ‰éˆ• -->
                            <a :href="'/product/' + product.slug" 
                               class="block w-full bg-gray-900 text-white text-center py-3 rounded-xl font-medium hover:bg-primary-600 transition-colors duration-200">
                                æŸ¥çœ‹è©³æƒ…
                            </a>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- æŸ¥çœ‹æ›´å¤šæŒ‰éˆ• -->
            <div class="text-center mt-12">
                <a href="/products" class="inline-flex items-center px-8 py-4 bg-primary-600 text-white rounded-2xl font-semibold hover:bg-primary-700 transition-all duration-300 transform hover:scale-105">
                    æŸ¥çœ‹æ‰€æœ‰å•†å“
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <!-- Latest Blog Posts -->
    <section class="py-16 lg:py-24 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4">æœ€æ–°æ–‡ç« </h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto mb-8">é–±è®€æˆ‘å€‘çš„æœ€æ–°å…§å®¹èˆ‡å°ˆæ¥­è¦‹è§£</p>
                <div class="w-24 h-1 bg-gradient-to-r from-primary-500 to-primary-600 mx-auto rounded-full"></div>
            </div>
            
            <!-- Loading State -->
            <div x-show="postsLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <template x-for="i in 3">
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-pulse">
                        <div class="aspect-video bg-gray-200"></div>
                        <div class="p-6">
                            <div class="h-4 bg-gray-200 rounded mb-2"></div>
                            <div class="h-4 bg-gray-200 rounded w-2/3 mb-4"></div>
                            <div class="h-20 bg-gray-200 rounded"></div>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- Posts Grid -->
            <div x-show="!postsLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <template x-for="post in latestPosts" :key="post.id">
                    <article class="bg-white rounded-2xl shadow-sm border border-gray-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 group overflow-hidden flex flex-col h-full">
                        <!-- æ–‡ç« åœ–ç‰‡ -->
                        <div class="aspect-video bg-gray-100 relative overflow-hidden" x-show="post.featured_image">
                            <img :src="post.featured_image || '/static/images/default-blog.jpg'" 
                                 :alt="post.title"
                                 class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                                 
                            <!-- åˆ†é¡æ¨™ç±¤ -->
                            <template x-if="post.categories && post.categories.length > 0">
                                <div class="absolute top-4 left-4">
                                    <span class="bg-primary-600 text-white px-3 py-1 rounded-full text-sm font-medium" 
                                          x-text="post.categories[0].name"></span>
                                </div>
                            </template>
                        </div>
                        
                        <!-- æ²’æœ‰åœ–ç‰‡æ™‚çš„ä½”ä½ -->
                        <div class="aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center" x-show="!post.featured_image">
                            <div class="text-6xl text-gray-400">ğŸ“</div>
                            
                            <!-- åˆ†é¡æ¨™ç±¤ -->
                            <template x-if="post.categories && post.categories.length > 0">
                                <div class="absolute top-4 left-4">
                                    <span class="bg-primary-600 text-white px-3 py-1 rounded-full text-sm font-medium" 
                                          x-text="post.categories[0].name"></span>
                                </div>
                            </template>
                        </div>
                        
                        <!-- æ–‡ç« å…§å®¹ -->
                        <div class="p-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-3 line-clamp-2 group-hover:text-primary-600 transition-colors duration-200">
                                <a :href="'/blog/' + post.slug" 
                                   class="hover:text-primary-600 transition-colors"
                                   x-text="post.title">
                                </a>
                            </h3>
                            <p class="text-gray-600 mb-4 line-clamp-3" x-text="post.excerpt"></p>
                            
                            <!-- ç™¼ä½ˆæ™‚é–“ -->
                            <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                                <div class="flex items-center space-x-2">
                                    <div class="w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-full flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        </svg>
                                    </div>
                                    <span>ç®¡ç†å“¡</span>
                                </div>
                                <time x-text="new Date(post.created_at).toLocaleDateString('zh-TW')"></time>
                            </div>
                            
                            <!-- é–±è®€æ›´å¤šæŒ‰éˆ• -->
                            <a :href="'/blog/' + post.slug" 
                               class="inline-flex items-center text-primary-600 hover:text-primary-700 font-medium transition-colors duration-200">
                                é–±è®€æ›´å¤š
                                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </a>
                        </div>
                    </article>
                </template>
            </div>
            
            <!-- æŸ¥çœ‹æ›´å¤šæŒ‰éˆ• -->
            <div class="text-center mt-12">
                <a href="/blog" class="inline-flex items-center px-8 py-4 bg-primary-600 text-white rounded-2xl font-semibold hover:bg-primary-700 transition-all duration-300 transform hover:scale-105">
                    æŸ¥çœ‹æ‰€æœ‰æ–‡ç« 
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="py-16 lg:py-24 bg-gradient-to-br from-primary-600 to-primary-800">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl lg:text-4xl font-bold text-white mb-4">è¨‚é–±æˆ‘å€‘çš„æœ€æ–°æ¶ˆæ¯</h2>
            <p class="text-xl text-primary-100 mb-10 max-w-2xl mx-auto">ç²å¾—ç¬¬ä¸€æ‰‹çš„ç”¢å“è³‡è¨Šèˆ‡å„ªæƒ æ´»å‹•é€šçŸ¥</p>
            
            <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto" @submit.prevent="subscribe()">
                <input type="email" 
                       placeholder="è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶" 
                       class="flex-1 px-6 py-4 rounded-2xl border-0 focus:ring-2 focus:ring-primary-300 focus:outline-none text-gray-900 placeholder-gray-500"
                       x-model="email"
                       required>
                <button type="submit" 
                        class="px-8 py-4 bg-white text-primary-700 rounded-2xl font-semibold hover:bg-gray-50 transition-all duration-300 transform hover:scale-105 whitespace-nowrap">
                    è¨‚é–±
                </button>
            </form>
            
            <p class="text-primary-100 text-sm mt-6">æˆ‘å€‘æ‰¿è«¾ä¿è­·æ‚¨çš„éš±ç§ï¼Œæ‚¨å¯ä»¥éš¨æ™‚å–æ¶ˆè¨‚é–±</p>
        </div>
    </section>
</div>

<script>
function homeApp() {
    return {
        featuredProducts: [],
        latestPosts: [],
        productsLoading: true,
        postsLoading: true,
        email: '',
        
        async loadContent() {
            await Promise.all([
                this.loadFeaturedProducts(),
                this.loadLatestPosts()
            ]);
        },
        
        async loadFeaturedProducts() {
            try {
                const response = await fetch('/api/products/?limit=4&featured=true&active=true');
                if (response.ok) {
                    this.featuredProducts = await response.json();
                }
            } catch (error) {
                console.error('è¼‰å…¥ç²¾é¸å•†å“å¤±æ•—:', error);
            } finally {
                this.productsLoading = false;
            }
        },
        
        async loadLatestPosts() {
            try {
                const response = await fetch('/api/posts/?limit=3&published=true');
                if (response.ok) {
                    this.latestPosts = await response.json();
                }
            } catch (error) {
                console.error('è¼‰å…¥æœ€æ–°æ–‡ç« å¤±æ•—:', error);
            } finally {
                this.postsLoading = false;
            }
        },
        
        async addToCart(productId, quantity = 1) {
            try {
                const response = await fetch('/api/cart/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        product_id: productId,
                        quantity: quantity
                    })
                });
                
                if (response.ok) {
                    // æ›´æ–°è³¼ç‰©è»Šè¨ˆæ•¸
                    window.updateCartCount();
                    
                    // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                    this.showNotification('å•†å“å·²åŠ å…¥è³¼ç‰©è»Šï¼', 'success');
                } else {
                    throw new Error('åŠ å…¥è³¼ç‰©è»Šå¤±æ•—');
                }
            } catch (error) {
                console.error('åŠ å…¥è³¼ç‰©è»ŠéŒ¯èª¤:', error);
                this.showNotification('åŠ å…¥è³¼ç‰©è»Šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 'error');
            }
        },
        
        formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('zh-TW', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        },
        
        showNotification(message, type = 'info') {
            // å‰µå»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-xl shadow-lg transition-all duration-300 transform translate-x-full ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-primary-600 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // é¡¯ç¤ºå‹•ç•«
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // è‡ªå‹•éš±è—
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        },
        
        async subscribe() {
            try {
                const response = await fetch('/api/newsletter/subscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: this.email })
                });
                if (!response.ok) {
                    const data = await response.json();
                    throw new Error(data.detail || 'è¨‚é–±å¤±æ•—');
                }
                this.email = '';
                this.showNotification('æ„Ÿè¬æ‚¨çš„è¨‚é–±ï¼', 'success');
            } catch (error) {
                console.error('è¨‚é–±éŒ¯èª¤:', error);
                this.showNotification(error.message || 'è¨‚é–±å¤±æ•—', 'error');
            }
        }
    }
}
</script>

<style>
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %} 