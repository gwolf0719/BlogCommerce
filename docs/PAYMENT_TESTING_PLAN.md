# 金流與訂單付款狀態管理測試計畫

## 測試環境
- 後端服務：http://localhost:8001
- 前端管理後台：http://localhost:5174
- 測試瀏覽器：Chrome, Firefox, Safari
- 測試日期：2025-06-26

## 測試項目概覽

### 1. 金流設定管理
- [ ] 轉帳設定功能
- [ ] Line Pay 設定功能  
- [ ] 綠界設定功能
- [ ] 設定資料儲存與讀取

### 2. 訂單付款狀態管理
- [ ] 付款狀態顯示
- [ ] 手動更新付款狀態
- [ ] 付款方式修改
- [ ] 付款資訊記錄

### 3. 金流串接功能
- [ ] 轉帳資訊顯示
- [ ] Line Pay 付款流程
- [ ] 綠界付款流程
- [ ] 付款回調處理

### 4. 用戶介面測試
- [ ] 結帳頁面金流選擇
- [ ] 管理後台訂單管理
- [ ] 付款結果頁面
- [ ] 響應式設計

## 詳細測試案例

### 測試案例 1：金流設定管理

#### 1.1 轉帳設定
**測試步驟：**
1. 登入管理後台 http://localhost:8001/admin
2. 進入「系統設定」頁面
3. 點擊「金流設定」分頁
4. 啟用「轉帳」付款方式
5. 填入銀行資訊：
   - 銀行名稱：測試銀行
   - 戶名：測試帳戶
   - 帳號：1234567890
6. 點擊「儲存設定」

**預期結果：**
- 設定成功儲存
- 顯示成功訊息
- 設定資料正確顯示

#### 1.2 Line Pay 設定
**測試步驟：**
1. 啟用「Line Pay」付款方式
2. 填入測試資訊：
   - Channel ID：test_channel_id
   - Channel Secret：test_channel_secret
   - 環境：沙盒環境
3. 點擊「儲存設定」

**預期結果：**
- 設定成功儲存
- Line Pay 選項在結帳頁面顯示

#### 1.3 綠界設定
**測試步驟：**
1. 啟用「綠界」付款方式
2. 填入測試資訊：
   - Merchant ID：test_merchant
   - Hash Key：test_hash_key
   - Hash IV：test_hash_iv
3. 點擊「儲存設定」

**預期結果：**
- 設定成功儲存
- 綠界選項在結帳頁面顯示

### 測試案例 2：訂單付款狀態管理

#### 2.1 訂單列表顯示
**測試步驟：**
1. 進入管理後台訂單管理頁面
2. 檢查訂單列表是否包含付款狀態欄位
3. 檢查訂單列表是否包含付款方式欄位

**預期結果：**
- 訂單列表正確顯示付款狀態
- 付款狀態使用對應顏色標籤
- 付款方式正確顯示

#### 2.2 訂單詳情付款管理
**測試步驟：**
1. 點擊任一訂單編號查看詳情
2. 檢查付款狀態管理區塊
3. 修改付款方式為「轉帳」
4. 修改付款狀態為「已付款」
5. 點擊「儲存」

**預期結果：**
- 付款狀態管理區塊正確顯示
- 修改成功並顯示成功訊息
- 訂單資料正確更新

### 測試案例 3：結帳流程測試

#### 3.1 轉帳付款流程
**測試步驟：**
1. 前台新增商品到購物車
2. 進入結帳頁面
3. 填寫收件人資訊
4. 選擇「銀行轉帳」付款方式
5. 點擊「確認下單」

**預期結果：**
- 訂單成功建立
- 顯示轉帳資訊彈窗
- 轉帳資訊正確顯示

#### 3.2 Line Pay 付款流程
**測試步驟：**
1. 選擇「Line Pay」付款方式
2. 點擊「確認下單」

**預期結果：**
- 訂單成功建立
- 正確跳轉到 Line Pay 付款頁面（沙盒環境）

#### 3.3 綠界付款流程
**測試步驟：**
1. 選擇「綠界科技」付款方式
2. 點擊「確認下單」

**預期結果：**
- 訂單成功建立
- 正確跳轉到綠界付款頁面（測試環境）

### 測試案例 4：付款回調處理

#### 4.1 Line Pay 回調測試
**測試步驟：**
1. 模擬 Line Pay 付款成功回調
2. 檢查訂單付款狀態是否更新為「已付款」
3. 檢查付款資訊是否正確記錄

**預期結果：**
- 訂單狀態正確更新
- 付款時間正確記錄
- 付款資訊完整保存

#### 4.2 綠界回調測試
**測試步驟：**
1. 模擬綠界付款成功回調
2. 檢查訂單付款狀態更新
3. 檢查回調資料驗證

**預期結果：**
- 回調驗證成功
- 訂單狀態正確更新
- 返回正確回應給綠界

### 測試案例 5：錯誤處理測試

#### 5.1 付款失敗處理
**測試步驟：**
1. 模擬付款失敗情況
2. 檢查錯誤訊息顯示
3. 檢查訂單狀態處理

**預期結果：**
- 顯示適當錯誤訊息
- 訂單狀態標記為「付款失敗」
- 用戶可重新嘗試付款

#### 5.2 網路異常處理
**測試步驟：**
1. 模擬網路連線異常
2. 檢查系統回應
3. 檢查錯誤恢復機制

**預期結果：**
- 顯示網路錯誤訊息
- 提供重試選項
- 不會產生重複訂單

## 效能測試

### 6.1 併發訂單處理
**測試步驟：**
1. 同時建立多個訂單
2. 檢查系統回應時間
3. 檢查資料一致性

**預期結果：**
- 系統穩定運行
- 回應時間在可接受範圍
- 資料無衝突

### 6.2 大量訂單查詢
**測試步驟：**
1. 建立大量測試訂單
2. 測試訂單列表載入速度
3. 測試搜尋功能效能

**預期結果：**
- 列表載入時間 < 3 秒
- 搜尋回應時間 < 1 秒
- 分頁功能正常

## 安全性測試

### 7.1 付款資料保護
**測試步驟：**
1. 檢查敏感資料加密
2. 檢查 API 權限控制
3. 檢查日誌記錄安全

**預期結果：**
- 敏感資料已加密儲存
- API 需要適當權限
- 日誌不包含敏感資訊

### 7.2 回調驗證安全
**測試步驟：**
1. 測試偽造回調請求
2. 檢查簽名驗證機制
3. 檢查重放攻擊防護

**預期結果：**
- 偽造請求被拒絕
- 簽名驗證正確執行
- 重放攻擊被防護

## 相容性測試

### 8.1 瀏覽器相容性
**測試環境：**
- Chrome 最新版
- Firefox 最新版
- Safari 最新版
- Edge 最新版

**測試項目：**
- 結帳頁面顯示
- 付款流程操作
- 管理後台功能

### 8.2 行動裝置相容性
**測試環境：**
- iOS Safari
- Android Chrome
- 不同螢幕尺寸

**測試項目：**
- 響應式設計
- 觸控操作
- 付款流程

## 測試結果記錄

### 測試執行日期：2025-06-26

| 測試項目 | 狀態 | 備註 |
|---------|------|------|
| 金流設定管理 | ⏳ 待測試 | |
| 訂單付款狀態管理 | ⏳ 待測試 | |
| 結帳流程 | ⏳ 待測試 | |
| 付款回調處理 | ⏳ 待測試 | |
| 錯誤處理 | ⏳ 待測試 | |
| 效能測試 | ⏳ 待測試 | |
| 安全性測試 | ⏳ 待測試 | |
| 相容性測試 | ⏳ 待測試 | |

## 問題追蹤

### 發現問題列表
1. 待發現...

### 已修復問題
1. 待記錄...

## 測試總結

### 測試覆蓋率
- 功能測試：100%
- 錯誤處理：100%  
- 效能測試：100%
- 安全性測試：100%

### 建議改進項目
1. 待測試後提出建議

### 發布建議
- [ ] 所有測試案例通過
- [ ] 效能指標達標
- [ ] 安全性檢查通過
- [ ] 文檔更新完成 